* Process the raw PME data and save as a csv.
* This script is a modified version of the script provided with the documentation.
* Author: Simon Greenhill, sgreenhill@uchicago.edu
* Date: 1/23/2020

* filename DIRLIST pipe 'dir "/mnt/ide0/sftp/sgreenhill/Raw/Data/BrazilTXT/*" /b ';
* filename DIRLIST pipe 'ls /mnt/ide0/sftp/sgreenhill/Raw/Data/BrazilTXT/';
filename DIRLIST pipe 'find /mnt/ide0/sftp/sgreenhill/Raw/Data/BrazilTXT/'

data dirlist;
infile dirlist lrecl=490 missover;
input file_name $100.;
run;

/* LAYOUT PARA LEITURA DE DADOS DA PME */
DATA PMENOVA;
INFILE '/mnt/ide0/sftp/sgreenhill/Raw/Data/BrazilTXT/PME_all.txt' LRECL=490 MISSOVER;
INPUT
@00001	V035	    2.	
@00003	V040	    8.	
@00011	V050	    5.	
@00016	V055	    1.	
@00017	V060	   $1.	
@00018	V063	    1.	
@00019	V070	    2.	
@00021	V075	    4.	
@00025	V072        1.
@00026	V104	    1.	
@00027	V105	    1.	
@00028	V106	    3.	
@00031	V107	   13.11
@00044	V108	   15.6	
@00059	V109	    4.	
@00063	V110	    6.	
@00069	V111	    4.	
@00073	V112	    6.	
@00079	V113	    5.	
@00084	V114	    9.	
@00093	V115	    9.2	
@00102	V201 	    2.	
@00104	V203	    1.	
@00105	V204	    2.	
@00107	V214	    2.	
@00109	V224	    4.
@00113	V234	    4.
@00117	V205	    1.
@00118	V206        1.
@00119	V207	    1.
@00120	V208	    1.
@00121	V209	    2.
@00123	V210	    2.
@00125	V211	    7.1
@00132	V215	    7.1
@00139	V218	    10.
@00149	V301	     1.
@00150	V302	     1.
@00151	V303	     2.
@00153	V304	     1.
@00154	V305	     1.
@00155	V306	     1.
@00156	V307	     2.
@00158	V308	     1.
@00159	V309         1
@00160	V310	     1.
@00161	V311	     1.
@00162	V312         1
@00163	V313	     1.
@00164	V314	     1.
@00165	V401	     1.
@00166	V402	     1.
@00167	V403	     1.
@00168	V404	     2.
@00170	V405 	     1.	
@00171	V4051	     2.	
@00173	V4052	     2.	
@00175	V4053	     2.	
@00177	V4054	     2.	
@00179	V406	     1.
@00180	V407A	     3.	
@00183	V408A	     2.	
@00185	V409	     1.
@00186	V410	     1.
@00187	V411	     1.
@00188	V412 	     1.	
@00189	V4121	     1.	
@00190	V4122	     2.	
@00192	V413	     1.
@00193	V414	     1.
@00194	V415	     1.
@00195	V416	     1.
@00196	V417	     1.
@00197	V418 	     1.	
@00198	V4182	     9.	
@00207	VI4182	     9.
@00216	V4191	     9.	
@00225	VI4191	     9.
@00234	V420	     1.
@00235	V421	     1.
@00236	V422 	     1.	
@00237	V4221	     1.	
@00238	V4222	     2.	
@00240	V4231	     9.	
@00249	VI4231	     9.
@00258	V4241	     9.	
@00267	VI4241	     9.
@00276	V425	     1.
@00277	V426	     1.
@00278	V4261	     1.	
@00279	V4262	     2.	
@00281	V427	     1.
@00282	V4271	     2.	
@00284	V4272	     2.	
@00286	V4273	     2.	
@00288	V4275	     2.	
@00290	V4274	     2.	
@00292	V428	     3.
@00295	V429	     3.
@00298	V430 	     1.	
@00299	V4302	     9.	
@00308	VI4302		 9.
@00317	V431 	     1
@00318	V4312	     9.	
@00327	VI4312		 9.
@00336	V432	     1.	
@00337	V433	     2.	
@00339	V434	     2.	
@00341	V435	     1.	
@00342	V436	     1.	
@00343	V437	     1.	
@00344	V438	     2.	
@00346	V439	     1.	
@00347	V440	     1.	
@00348	V441	     1.	
@00349	V442	     1.	
@00350	V443	     1.	
@00351	V444	     1.	
@00352	V445A	     3.
@00355	V446A	     2.
@00357	V447	     1.	
@00358	V448	     1.	
@00359	V449	     1.	
@00360	V450	     1.	
@00361	V451	     1.	
@00362	V452	     1.	
@00363	V4521	     2.	
@00365	V4522	     2.	
@00367	V4523	     2.	
@00369	V4524	     2.	
@00371	V453	     1.	
@00372	V454	     1.	
@00373	V4541	     2.	
@00375	V4542	     2.	
@00377	V4543	     2.	
@00379	V4544	     2.	
@00381	V455	     1.	
@00382	V456	     1.	
@00383	V457	     2.	
@00385	V458	     1.
@00386	V459	     1.
@00387	V460 	     2.	
@00389	V461	     2.	
@00391	V471	     2.	
@00393	V481	     4.	
@00397	V462	     2.	
@00399	V463 	     1.	
@00400	V4631	     2.	
@00402	V4632	     2.	
@00404	V4633	     2.	
@00406	V4634	     2.	
@00408	V4635	     2.	
@00410	 V464	     1.	
@00411	V465	     1.	
@00412	V466	     1.	
@00413	V467	     3.	
@00416	V468	     1.	
@00417	VD1			 1.
@00418	VD2			 1.
@00419	VD3			 1.
@00420	VD4			 1.
@00421	VD5			 1.
@00422	VD6			 1.
@00423	VD7			 1.
@00424	VD8			 1.
@00425	VD9			 1.
@00426	VD10		 1.	  
@00427	VD11		 1.	  
@00428	VD12		 1.	  
@00429	VD13	     1.	
@00430	VD14	     1.	
@00431	VD15	     1.	
@00432	VD16	     1.	
@00433	VD17	     1.	
@00434	VD18	     1.	
@00435	VD19	     1.	
@00436	VD20	     1.	
@00437	VD21	     1.	
@00438	VD22	     1.	
@00439	VD23	     9.	
@00448	VD24	     9.	
@00457	VD25	     9.	
@00466	VD26	     9.	
@00475	VD27	     3.	
@00478	VD28	     3.	
@00481	VDAE1   	 1.
@00482	VDAE2   	 1.
;

proc export data=PMENOVA
outfile='/mnt/ide0/sftp/sgreenhill/Raw/Data/BrazilTXT/pme_all'
dbms=csv;
run;
